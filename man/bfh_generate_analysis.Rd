% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spc_analysis.R
\name{bfh_generate_analysis}
\alias{bfh_generate_analysis}
\title{Generate SPC Analysis Text}
\usage{
bfh_generate_analysis(x, metadata = list(), use_ai = NULL, max_chars = 350)
}
\arguments{
\item{x}{A \code{bfh_qic_result} object from \code{bfh_qic()}}

\item{metadata}{Optional list with additional context for AI:
\itemize{
\item \code{data_definition}: Description of what the data represents
\item \code{target}: Target value for the metric
\item \code{hospital}: Hospital name
\item \code{department}: Department name
\item \code{chart_title}: Override chart title
\item \code{y_axis_unit}: Override y-axis unit
}}

\item{use_ai}{Logical. Should AI be used for analysis generation?
\itemize{
\item \code{NULL} (default): Auto-detect BFHllm availability
\item \code{TRUE}: Use AI (requires BFHllm package)
\item \code{FALSE}: Use standard texts only
}}

\item{max_chars}{Maximum characters in AI-generated output. Default 350.}
}
\value{
Character string with analysis text suitable for PDF export.
}
\description{
Generates analysis text for PDF export using AI (BFHllm) if available,
with automatic fallback to Danish standard texts.
}
\details{
When \code{use_ai = TRUE} and BFHllm is installed, the function:
\enumerate{
\item Builds context from the \code{bfh_qic_result} and metadata
\item Calls \code{BFHllm::bfhllm_spc_suggestion()} for AI-generated analysis
\item Falls back to standard texts if AI call fails
}

When \code{use_ai = FALSE} or BFHllm is not installed:
\itemize{
\item Returns Danish standard texts based on Anh√∏j SPC rules
}
}
\examples{
\dontrun{
result <- bfh_qic(data, x = date, y = value, chart_type = "i")

# Use standard texts (no AI)
analysis <- bfh_generate_analysis(result, use_ai = FALSE)

# Use AI if available
analysis <- bfh_generate_analysis(result,
  metadata = list(
    data_definition = "Antal infektioner pr. 1000 patientdage",
    target = 2.5
  ),
  use_ai = TRUE
)
}

}
